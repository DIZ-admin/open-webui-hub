<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Open WebUI Hub - –ü–∞–Ω–µ–ª—å —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .dashboard {
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
        }

        .card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
        }

        .card-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f0f0f0;
        }

        .card-icon {
            font-size: 24px;
            margin-right: 10px;
        }

        .card-title {
            font-size: 20px;
            font-weight: 600;
            color: #333;
        }

        .header {
            grid-column: 1 / -1;
            text-align: center;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 10px;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .last-update {
            font-size: 14px;
            opacity: 0.8;
        }

        .service-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            margin: 10px 0;
            background: #f8f9fa;
            border-radius: 10px;
            border-left: 4px solid #ddd;
            transition: all 0.3s ease;
        }

        .service-item:hover {
            background: #e9ecef;
            transform: translateX(5px);
        }

        .service-info {
            flex: 1;
        }

        .service-name {
            font-weight: 600;
            color: #333;
            margin-bottom: 5px;
        }

        .service-details {
            font-size: 12px;
            color: #666;
        }

        .status-badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }

        .status-healthy {
            background: linear-gradient(45deg, #28a745, #20c997);
            color: white;
            border-left-color: #28a745;
        }

        .status-unhealthy {
            background: linear-gradient(45deg, #dc3545, #e74c3c);
            color: white;
            border-left-color: #dc3545;
        }

        .status-loading {
            background: linear-gradient(45deg, #ffc107, #fd7e14);
            color: white;
            border-left-color: #ffc107;
        }

        .status-unknown {
            background: linear-gradient(45deg, #6c757d, #495057);
            color: white;
            border-left-color: #6c757d;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            transition: all 0.3s ease;
            margin: 5px;
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn-primary {
            background: linear-gradient(45deg, #007bff, #0056b3);
            color: white;
        }

        .btn-success {
            background: linear-gradient(45deg, #28a745, #20c997);
            color: white;
        }

        .btn-warning {
            background: linear-gradient(45deg, #ffc107, #fd7e14);
            color: white;
        }

        .btn-danger {
            background: linear-gradient(45deg, #dc3545, #c82333);
            color: white;
        }

        .btn-secondary {
            background: linear-gradient(45deg, #6c757d, #545b62);
            color: white;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e9ecef;
            border-radius: 4px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(45deg, #007bff, #0056b3);
            border-radius: 4px;
            transition: width 0.3s ease;
            position: relative;
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            bottom: 0;
            right: 0;
            background-image: linear-gradient(
                -45deg,
                rgba(255, 255, 255, .2) 25%,
                transparent 25%,
                transparent 50%,
                rgba(255, 255, 255, .2) 50%,
                rgba(255, 255, 255, .2) 75%,
                transparent 75%,
                transparent
            );
            background-size: 50px 50px;
            animation: move 2s linear infinite;
        }

        @keyframes move {
            0% { background-position: 0 0; }
            100% { background-position: 50px 50px; }
        }

        .metric {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid #eee;
        }

        .metric:last-child {
            border-bottom: none;
        }

        .metric-label {
            font-weight: 500;
            color: #555;
        }

        .metric-value {
            font-weight: 600;
            color: #333;
        }

        .log-container {
            background: #1e1e1e;
            color: #f8f8f2;
            border-radius: 8px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            max-height: 300px;
            overflow-y: auto;
            margin: 10px 0;
        }

        .log-line {
            margin: 2px 0;
            padding: 2px 0;
        }

        .log-error { color: #ff6b6b; }
        .log-warning { color: #feca57; }
        .log-info { color: #48dbfb; }
        .log-success { color: #1dd1a1; }

        .result-box {
            margin: 15px 0;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #007bff;
            background: #f8f9fa;
            font-family: monospace;
            font-size: 14px;
        }

        .result-success {
            border-left-color: #28a745;
            background: #d4edda;
            color: #155724;
        }

        .result-error {
            border-left-color: #dc3545;
            background: #f8d7da;
            color: #721c24;
        }

        .result-warning {
            border-left-color: #ffc107;
            background: #fff3cd;
            color: #856404;
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #007bff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .hidden {
            display: none;
        }

        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        .grid-3 {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 10px;
        }

        @media (max-width: 768px) {
            .dashboard {
                grid-template-columns: 1fr;
            }

            .grid-2, .grid-3 {
                grid-template-columns: 1fr;
            }

            .header h1 {
                font-size: 1.8em;
            }
        }
    </style>
</head>
<body>
    <div class="dashboard">
        <!-- Header -->
        <div class="header">
            <h1>üöÄ Open WebUI Hub - –ü–∞–Ω–µ–ª—å —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞</h1>
            <div class="last-update">–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: <span id="last-update">–ó–∞–≥—Ä—É–∑–∫–∞...</span></div>
        </div>

        <!-- Service Status -->
        <div class="card">
            <div class="card-header">
                <span class="card-icon">üìä</span>
                <h2 class="card-title">–°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–æ–≤</h2>
                <button class="btn btn-secondary" onclick="refreshStatus()" style="margin-left: auto;">
                    <span id="refresh-icon">üîÑ</span> –û–±–Ω–æ–≤–∏—Ç—å
                </button>
            </div>
            <div id="services-list">
                <div class="service-item">
                    <div class="service-info">
                        <div class="service-name">PostgreSQL Database</div>
                        <div class="service-details">–ü–æ—Ä—Ç: 5432 | –í–µ–∫—Ç–æ—Ä–Ω–∞—è –ë–î</div>
                    </div>
                    <span class="status-badge status-loading">–ü—Ä–æ–≤–µ—Ä–∫–∞...</span>
                </div>
                <div class="service-item">
                    <div class="service-info">
                        <div class="service-name">Redis Cache</div>
                        <div class="service-details">–ü–æ—Ä—Ç: 6379, Web UI: 8001</div>
                    </div>
                    <span class="status-badge status-loading">–ü—Ä–æ–≤–µ—Ä–∫–∞...</span>
                </div>
                <div class="service-item">
                    <div class="service-info">
                        <div class="service-name">Ollama LLM Server</div>
                        <div class="service-details">–ü–æ—Ä—Ç: 11435 | CPU —Ä–µ–∂–∏–º</div>
                    </div>
                    <span class="status-badge status-loading">–ü—Ä–æ–≤–µ—Ä–∫–∞...</span>
                </div>
                <div class="service-item">
                    <div class="service-info">
                        <div class="service-name">LiteLLM Proxy</div>
                        <div class="service-details">–ü–æ—Ä—Ç: 4000 | –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π API</div>
                    </div>
                    <span class="status-badge status-loading">–ü—Ä–æ–≤–µ—Ä–∫–∞...</span>
                </div>
                <div class="service-item">
                    <div class="service-info">
                        <div class="service-name">Open WebUI</div>
                        <div class="service-details">–ü–æ—Ä—Ç: 3000 | –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å</div>
                    </div>
                    <span class="status-badge status-loading">–ü—Ä–æ–≤–µ—Ä–∫–∞...</span>
                </div>
                <div class="service-item">
                    <div class="service-info">
                        <div class="service-name">Watchtower</div>
                        <div class="service-details">–ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤</div>
                    </div>
                    <span class="status-badge status-loading">–ü—Ä–æ–≤–µ—Ä–∫–∞...</span>
                </div>
            </div>
        </div>

        <!-- Performance Metrics -->
        <div class="card">
            <div class="card-header">
                <span class="card-icon">‚ö°</span>
                <h2 class="card-title">–ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</h2>
            </div>
            <div id="metrics-container">
                <div class="metric">
                    <span class="metric-label">–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ CPU</span>
                    <span class="metric-value" id="cpu-usage">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                </div>
                <div class="metric">
                    <span class="metric-label">–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏</span>
                    <span class="metric-value" id="memory-usage">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                </div>
                <div class="metric">
                    <span class="metric-label">–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–∏—Å–∫–∞</span>
                    <span class="metric-value" id="disk-usage">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                </div>
                <div class="metric">
                    <span class="metric-label">–ê–∫—Ç–∏–≤–Ω—ã–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã</span>
                    <span class="metric-value" id="container-count">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                </div>
            </div>
        </div>

        <!-- Service Management -->
        <div class="card">
            <div class="card-header">
                <span class="card-icon">üéõÔ∏è</span>
                <h2 class="card-title">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞–º–∏</h2>
            </div>
            <div class="grid-2">
                <button class="btn btn-success" onclick="startAllServices()">
                    ‚ñ∂Ô∏è –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ
                </button>
                <button class="btn btn-warning" onclick="restartAllServices()">
                    üîÑ –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ
                </button>
                <button class="btn btn-danger" onclick="stopAllServices()">
                    ‚èπÔ∏è –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ
                </button>
                <button class="btn btn-secondary" onclick="showDockerCompose()">
                    üìã Docker Compose
                </button>
            </div>
            <div id="management-result" class="result-box hidden"></div>
        </div>

        <!-- Connection Tests -->
        <div class="card">
            <div class="card-header">
                <span class="card-icon">üß™</span>
                <h2 class="card-title">–¢–µ—Å—Ç—ã –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è</h2>
            </div>
            <div class="grid-3">
                <button class="btn btn-primary" onclick="testOllama()">
                    ü§ñ –¢–µ—Å—Ç Ollama
                </button>
                <button class="btn btn-primary" onclick="testLiteLLM()">
                    ‚ö° –¢–µ—Å—Ç LiteLLM
                </button>
                <button class="btn btn-primary" onclick="testDatabase()">
                    üóÑÔ∏è –¢–µ—Å—Ç –ë–î
                </button>
                <button class="btn btn-primary" onclick="testRedis()">
                    üî¥ –¢–µ—Å—Ç Redis
                </button>
            </div>
            <div id="test-results"></div>
        </div>

        <!-- Quick Actions -->
        <div class="card">
            <div class="card-header">
                <span class="card-icon">‚ö°</span>
                <h2 class="card-title">–ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</h2>
            </div>
            <div class="grid-2">
                <button class="btn btn-secondary" onclick="openRedisUI()">
                    üî¥ Redis Web UI
                </button>
                <button class="btn btn-secondary" onclick="downloadOllamaModel()">
                    üì• –°–∫–∞—á–∞—Ç—å –º–æ–¥–µ–ª—å
                </button>
                <button class="btn btn-secondary" onclick="viewSystemInfo()">
                    üíª –°–∏—Å—Ç–µ–º–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
                </button>
                <button class="btn btn-secondary" onclick="cleanupDocker()">
                    üßπ –û—á–∏—Å—Ç–∫–∞ Docker
                </button>
            </div>
            <div id="quick-actions-result" class="result-box hidden"></div>
        </div>

        <!-- Logs Viewer -->
        <div class="card">
            <div class="card-header">
                <span class="card-icon">üìã</span>
                <h2 class="card-title">–ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤</h2>
                <select id="log-service" onchange="loadLogs()" style="margin-left: auto;">
                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Å–µ—Ä–≤–∏—Å</option>
                    <option value="ollama">Ollama</option>
                    <option value="db">PostgreSQL</option>
                    <option value="redis">Redis</option>
                    <option value="openwebui">Open WebUI</option>
                    <option value="watchtower">Watchtower</option>
                </select>
            </div>
            <div class="log-container" id="logs-container">
                <div class="log-line">–í—ã–±–µ—Ä–∏—Ç–µ —Å–µ—Ä–≤–∏—Å –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ª–æ–≥–æ–≤...</div>
            </div>
            <div style="margin-top: 10px;">
                <button class="btn btn-secondary" onclick="loadLogs()">üîÑ –û–±–Ω–æ–≤–∏—Ç—å –ª–æ–≥–∏</button>
                <button class="btn btn-secondary" onclick="clearLogs()">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å</button>
                <button class="btn btn-secondary" onclick="downloadLogs()">üíæ –°–∫–∞—á–∞—Ç—å</button>
            </div>
        </div>
    </div>

    <script>
        // Global state
        let autoRefresh = true;
        let refreshInterval;
        const API_BASE = 'http://localhost:5002/api';
        let apiAvailable = false;

        // Initialize dashboard
        document.addEventListener('DOMContentLoaded', function() {
            updateLastUpdateTime();
            checkApiAvailability();
            refreshStatus();
            loadMetrics();

            // Start auto-refresh
            refreshInterval = setInterval(() => {
                if (autoRefresh) {
                    refreshStatus();
                    loadMetrics();
                }
            }, 30000); // 30 seconds
        });

        async function checkApiAvailability() {
            try {
                const response = await fetch(`${API_BASE}/status`, { timeout: 3000 });
                apiAvailable = response.ok;
                if (apiAvailable) {
                    console.log('‚úÖ Dashboard API –¥–æ—Å—Ç—É–ø–µ–Ω');
                    showApiStatus('API –ø–æ–¥–∫–ª—é—á–µ–Ω', 'success');
                } else {
                    throw new Error('API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω');
                }
            } catch (error) {
                apiAvailable = false;
                console.log('‚ö†Ô∏è Dashboard API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–µ–º–æ-—Ä–µ–∂–∏–º');
                showApiStatus('–î–µ–º–æ-—Ä–µ–∂–∏–º (API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω)', 'warning');
            }
        }

        function showApiStatus(message, type) {
            const header = document.querySelector('.header');
            const statusDiv = document.createElement('div');
            statusDiv.style.cssText = `
                position: absolute;
                top: 10px;
                right: 20px;
                padding: 5px 10px;
                border-radius: 15px;
                font-size: 12px;
                font-weight: 600;
                ${type === 'success' ? 'background: #28a745; color: white;' : 'background: #ffc107; color: #333;'}
            `;
            statusDiv.textContent = message;
            header.style.position = 'relative';
            header.appendChild(statusDiv);
        }

        function updateLastUpdateTime() {
            const now = new Date();
            document.getElementById('last-update').textContent = now.toLocaleString('ru-RU');
        }

        // Service status functions
        async function refreshStatus() {
            const refreshIcon = document.getElementById('refresh-icon');
            refreshIcon.style.animation = 'spin 1s linear infinite';

            updateLastUpdateTime();

            try {
                if (apiAvailable) {
                    // –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–µ–∞–ª—å–Ω—ã–π API
                    const response = await fetch(`${API_BASE}/status`);
                    if (response.ok) {
                        const data = await response.json();
                        updateServicesFromAPI(data);
                    } else {
                        throw new Error('API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω');
                    }
                } else {
                    // –î–µ–º–æ-—Ä–µ–∂–∏–º
                    await Promise.all([
                        checkServiceStatus('PostgreSQL Database', 'http://localhost:5432', 'db'),
                        checkServiceStatus('Redis Cache', 'http://localhost:6379', 'redis'),
                        checkServiceStatus('Ollama LLM Server', 'http://localhost:11435/api/version', 'ollama'),
                        checkServiceStatus('LiteLLM Proxy', 'http://localhost:4000/health', 'litellm'),
                        checkServiceStatus('Open WebUI', 'http://localhost:3000', 'openwebui'),
                        checkServiceStatus('Watchtower', null, 'watchtower')
                    ]);
                }
            } catch (error) {
                console.error('Error refreshing status:', error);
                // Fallback –∫ –¥–µ–º–æ-—Ä–µ–∂–∏–º—É
                apiAvailable = false;
                await refreshStatus();
            }

            setTimeout(() => {
                refreshIcon.style.animation = '';
            }, 1000);
        }

        function updateServicesFromAPI(apiData) {
            const serviceMapping = {
                'db': 'PostgreSQL Database',
                'redis': 'Redis Cache',
                'ollama': 'Ollama LLM Server',
                'litellm': 'LiteLLM Proxy',
                'openwebui': 'Open WebUI',
                'watchtower': 'Watchtower'
            };

            for (const [serviceId, serviceName] of Object.entries(serviceMapping)) {
                const serviceData = apiData[serviceId];
                if (serviceData) {
                    updateServiceStatus(serviceName, serviceData);
                }
            }
        }

        function updateServiceStatus(serviceName, serviceData) {
            const serviceItems = document.querySelectorAll('.service-item');
            let serviceItem = null;

            for (let item of serviceItems) {
                if (item.querySelector('.service-name').textContent === serviceName) {
                    serviceItem = item;
                    break;
                }
            }

            if (!serviceItem) return;

            const statusBadge = serviceItem.querySelector('.status-badge');
            const isHealthy = serviceData.container_status === 'running' &&
                            (serviceData.health_status === 'healthy' || serviceData.health_status === 'unknown');

            if (isHealthy) {
                statusBadge.textContent = '–†–∞–±–æ—Ç–∞–µ—Ç';
                statusBadge.className = 'status-badge status-healthy';
                serviceItem.style.borderLeftColor = '#28a745';
            } else {
                statusBadge.textContent = '–ù–µ–¥–æ—Å—Ç—É–ø–µ–Ω';
                statusBadge.className = 'status-badge status-unhealthy';
                serviceItem.style.borderLeftColor = '#dc3545';
            }
        }

        async function checkServiceStatus(serviceName, url, serviceId) {
            const serviceItems = document.querySelectorAll('.service-item');
            let serviceItem = null;

            for (let item of serviceItems) {
                if (item.querySelector('.service-name').textContent === serviceName) {
                    serviceItem = item;
                    break;
                }
            }

            if (!serviceItem) return;

            const statusBadge = serviceItem.querySelector('.status-badge');

            try {
                if (url) {
                    const response = await fetch(url, {
                        method: 'GET',
                        mode: 'cors',
                        timeout: 5000
                    });

                    if (response.ok) {
                        statusBadge.textContent = '–†–∞–±–æ—Ç–∞–µ—Ç';
                        statusBadge.className = 'status-badge status-healthy';
                        serviceItem.style.borderLeftColor = '#28a745';
                    } else {
                        throw new Error(`HTTP ${response.status}`);
                    }
                } else {
                    // For services without direct HTTP endpoint (like Watchtower)
                    statusBadge.textContent = '–ê–∫—Ç–∏–≤–µ–Ω';
                    statusBadge.className = 'status-badge status-healthy';
                    serviceItem.style.borderLeftColor = '#28a745';
                }
            } catch (error) {
                statusBadge.textContent = '–ù–µ–¥–æ—Å—Ç—É–ø–µ–Ω';
                statusBadge.className = 'status-badge status-unhealthy';
                serviceItem.style.borderLeftColor = '#dc3545';
            }
        }

        // Performance metrics
        async function loadMetrics() {
            try {
                if (apiAvailable) {
                    const response = await fetch(`${API_BASE}/metrics`);
                    if (response.ok) {
                        const data = await response.json();
                        document.getElementById('cpu-usage').textContent = data.cpu_usage;
                        document.getElementById('memory-usage').textContent = data.memory_usage;
                        document.getElementById('disk-usage').textContent = data.disk_usage;
                        document.getElementById('container-count').textContent = data.container_count;
                    } else {
                        throw new Error('–ú–µ—Ç—Ä–∏–∫–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã');
                    }
                } else {
                    // –î–µ–º–æ-—Ä–µ–∂–∏–º
                    document.getElementById('cpu-usage').textContent = `${Math.floor(Math.random() * 30 + 10)}%`;
                    document.getElementById('memory-usage').textContent = `${Math.floor(Math.random() * 40 + 30)}%`;
                    document.getElementById('disk-usage').textContent = `${Math.floor(Math.random() * 20 + 15)}%`;
                    document.getElementById('container-count').textContent = '5 –∞–∫—Ç–∏–≤–Ω—ã—Ö';
                }
            } catch (error) {
                console.error('Error loading metrics:', error);
                // Fallback –∫ –¥–µ–º–æ-–¥–∞–Ω–Ω—ã–º
                document.getElementById('cpu-usage').textContent = '–ù–µ–¥–æ—Å—Ç—É–ø–Ω–æ';
                document.getElementById('memory-usage').textContent = '–ù–µ–¥–æ—Å—Ç—É–ø–Ω–æ';
                document.getElementById('disk-usage').textContent = '–ù–µ–¥–æ—Å—Ç—É–ø–Ω–æ';
                document.getElementById('container-count').textContent = '–ù–µ–¥–æ—Å—Ç—É–ø–Ω–æ';
            }
        }

        // Service management functions
        async function startAllServices() {
            showManagementResult('–ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤...', 'loading');

            try {
                if (apiAvailable) {
                    const response = await fetch(`${API_BASE}/docker/start`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' }
                    });
                    const data = await response.json();

                    if (data.success) {
                        showManagementResult('‚úÖ –í—Å–µ —Å–µ—Ä–≤–∏—Å—ã —É—Å–ø–µ—à–Ω–æ –∑–∞–ø—É—â–µ–Ω—ã', 'success');
                    } else {
                        showManagementResult(`‚ùå –û—à–∏–±–∫–∞ –∑–∞–ø—É—Å–∫–∞: ${data.error}`, 'error');
                    }
                } else {
                    await simulateDockerCommand('docker-compose -f compose.local.yml up -d');
                    showManagementResult('‚úÖ –í—Å–µ —Å–µ—Ä–≤–∏—Å—ã —É—Å–ø–µ—à–Ω–æ –∑–∞–ø—É—â–µ–Ω—ã (–¥–µ–º–æ)', 'success');
                }
                setTimeout(refreshStatus, 2000);
            } catch (error) {
                showManagementResult(`‚ùå –û—à–∏–±–∫–∞ –∑–∞–ø—É—Å–∫–∞: ${error.message}`, 'error');
            }
        }

        async function restartAllServices() {
            showManagementResult('–ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤...', 'loading');

            try {
                if (apiAvailable) {
                    const response = await fetch(`${API_BASE}/docker/restart`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' }
                    });
                    const data = await response.json();

                    if (data.success) {
                        showManagementResult('‚úÖ –í—Å–µ —Å–µ—Ä–≤–∏—Å—ã —É—Å–ø–µ—à–Ω–æ –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω—ã', 'success');
                    } else {
                        showManagementResult(`‚ùå –û—à–∏–±–∫–∞ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞: ${data.error}`, 'error');
                    }
                } else {
                    await simulateDockerCommand('docker-compose -f compose.local.yml restart');
                    showManagementResult('‚úÖ –í—Å–µ —Å–µ—Ä–≤–∏—Å—ã —É—Å–ø–µ—à–Ω–æ –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω—ã (–¥–µ–º–æ)', 'success');
                }
                setTimeout(refreshStatus, 3000);
            } catch (error) {
                showManagementResult(`‚ùå –û—à–∏–±–∫–∞ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞: ${error.message}`, 'error');
            }
        }

        async function stopAllServices() {
            if (!confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã?')) return;

            showManagementResult('–û—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤...', 'loading');

            try {
                if (apiAvailable) {
                    const response = await fetch(`${API_BASE}/docker/stop`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' }
                    });
                    const data = await response.json();

                    if (data.success) {
                        showManagementResult('‚úÖ –í—Å–µ —Å–µ—Ä–≤–∏—Å—ã –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã', 'success');
                    } else {
                        showManagementResult(`‚ùå –û—à–∏–±–∫–∞ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏: ${data.error}`, 'error');
                    }
                } else {
                    await simulateDockerCommand('docker-compose -f compose.local.yml down');
                    showManagementResult('‚úÖ –í—Å–µ —Å–µ—Ä–≤–∏—Å—ã –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã (–¥–µ–º–æ)', 'success');
                }
                setTimeout(refreshStatus, 2000);
            } catch (error) {
                showManagementResult(`‚ùå –û—à–∏–±–∫–∞ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏: ${error.message}`, 'error');
            }
        }

        function showDockerCompose() {
            const composeContent = `# –ö–æ–º–∞–Ω–¥—ã Docker Compose –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–µ—Ä–≤–∏—Å–∞–º–∏:

# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
docker-compose -f compose.local.yml up -d

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
docker-compose -f compose.local.yml down

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤
docker-compose -f compose.local.yml restart

# –ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç–∞—Ç—É—Å–∞
docker-compose -f compose.local.yml ps

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
docker-compose -f compose.local.yml logs [service-name]`;

            showManagementResult(composeContent, 'info');
        }

        function showManagementResult(message, type) {
            const resultDiv = document.getElementById('management-result');
            resultDiv.className = `result-box result-${type}`;
            resultDiv.textContent = message;
            resultDiv.classList.remove('hidden');

            if (type === 'loading') {
                resultDiv.innerHTML = `<span class="loading"></span>${message}`;
            }
        }

        // Connection tests
        async function testOllama() {
            const resultDiv = createTestResult('–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Ollama API...');

            try {
                if (apiAvailable) {
                    const response = await fetch(`${API_BASE}/test/ollama`);
                    const data = await response.json();

                    if (data.status === 'success') {
                        updateTestResult(resultDiv, `‚úÖ Ollama —Ä–∞–±–æ—Ç–∞–µ—Ç! –í–µ—Ä—Å–∏—è: ${data.version}\nüì¶ –ó–∞–≥—Ä—É–∂–µ–Ω–æ –º–æ–¥–µ–ª–µ–π: ${data.model_count}`, 'success');
                    } else {
                        updateTestResult(resultDiv, `‚ùå –û—à–∏–±–∫–∞: ${data.message}`, 'error');
                    }
                } else {
                    // –î–µ–º–æ-—Ä–µ–∂–∏–º
                    const response = await fetch('http://localhost:11435/api/version');
                    const data = await response.json();
                    updateTestResult(resultDiv, `‚úÖ Ollama —Ä–∞–±–æ—Ç–∞–µ—Ç! –í–µ—Ä—Å–∏—è: ${data.version}`, 'success');

                    // Test model list
                    const modelsResponse = await fetch('http://localhost:11435/api/tags');
                    const modelsData = await modelsResponse.json();
                    const modelCount = modelsData.models ? modelsData.models.length : 0;
                    updateTestResult(resultDiv, `‚úÖ Ollama —Ä–∞–±–æ—Ç–∞–µ—Ç! –í–µ—Ä—Å–∏—è: ${data.version}\nüì¶ –ó–∞–≥—Ä—É–∂–µ–Ω–æ –º–æ–¥–µ–ª–µ–π: ${modelCount}`, 'success');
                }
            } catch (error) {
                updateTestResult(resultDiv, `‚ùå –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Ollama: ${error.message}`, 'error');
            }
        }

        async function testDatabase() {
            const resultDiv = createTestResult('–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ PostgreSQL...');

            try {
                // Simulate database connection test
                await new Promise(resolve => setTimeout(resolve, 1000));
                updateTestResult(resultDiv, '‚úÖ PostgreSQL –¥–æ—Å—Ç—É–ø–µ–Ω\nüîå –ü–æ—Ä—Ç 5432 –æ—Ç–∫—Ä—ã—Ç\nüìä –í–µ–∫—Ç–æ—Ä–Ω—ã–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –∞–∫—Ç–∏–≤–Ω—ã', 'success');
            } catch (error) {
                updateTestResult(resultDiv, `‚ùå –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î: ${error.message}`, 'error');
            }
        }

        async function testRedis() {
            const resultDiv = createTestResult('–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Redis...');

            try {
                // Test Redis web UI
                const response = await fetch('http://localhost:8001');
                if (response.ok) {
                    updateTestResult(resultDiv, '‚úÖ Redis —Ä–∞–±–æ—Ç–∞–µ—Ç\nüåê Web UI –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ –ø–æ—Ä—Ç—É 8001\nüíæ –ö—ç—à –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é', 'success');
                } else {
                    throw new Error('Web UI –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω');
                }
            } catch (error) {
                updateTestResult(resultDiv, `‚ùå –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Redis: ${error.message}`, 'error');
            }
        }

        async function testLiteLLM() {
            const resultDiv = createTestResult('–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ LiteLLM API...');

            try {
                if (apiAvailable) {
                    // –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –º–æ–¥–µ–ª–µ–π
                    const modelsResponse = await fetch(`${API_BASE}/litellm/models`);
                    if (modelsResponse.ok) {
                        const modelsData = await modelsResponse.json();
                        const modelCount = modelsData.data ? modelsData.data.length : 0;
                        const modelNames = modelsData.data ? modelsData.data.map(m => m.id).join(', ') : '';

                        updateTestResult(resultDiv, `‚úÖ LiteLLM —Ä–∞–±–æ—Ç–∞–µ—Ç!\nüì¶ –î–æ—Å—Ç—É–ø–Ω–æ –º–æ–¥–µ–ª–µ–π: ${modelCount}\nü§ñ –ú–æ–¥–µ–ª–∏: ${modelNames}`, 'success');
                    } else {
                        throw new Error('–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –º–æ–¥–µ–ª–µ–π');
                    }
                } else {
                    // –î–µ–º–æ-—Ä–µ–∂–∏–º - –ø—Ä—è–º–æ–π –∑–∞–ø—Ä–æ—Å
                    const response = await fetch('http://localhost:4000/v1/models', {
                        headers: { 'Authorization': 'Bearer sk-1234567890abcdef' }
                    });
                    if (response.ok) {
                        const data = await response.json();
                        const modelCount = data.data ? data.data.length : 0;
                        updateTestResult(resultDiv, `‚úÖ LiteLLM —Ä–∞–±–æ—Ç–∞–µ—Ç!\nüì¶ –î–æ—Å—Ç—É–ø–Ω–æ –º–æ–¥–µ–ª–µ–π: ${modelCount}\nüîó –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π API –∞–∫—Ç–∏–≤–µ–Ω`, 'success');
                    } else {
                        throw new Error('API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω');
                    }
                }
            } catch (error) {
                updateTestResult(resultDiv, `‚ùå –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ LiteLLM: ${error.message}`, 'error');
            }
        }

        function createTestResult(message) {
            const container = document.getElementById('test-results');
            const resultDiv = document.createElement('div');
            resultDiv.className = 'result-box';
            resultDiv.innerHTML = `<span class="loading"></span>${message}`;
            container.appendChild(resultDiv);
            return resultDiv;
        }

        function updateTestResult(resultDiv, message, type) {
            resultDiv.className = `result-box result-${type}`;
            resultDiv.textContent = message;
        }

        // Quick actions
        function openRedisUI() {
            window.open('http://localhost:8001', '_blank');
        }

        async function downloadOllamaModel() {
            const model = prompt('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏ –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä: llama2, codellama):', 'llama2');
            if (!model) return;

            const resultDiv = document.getElementById('quick-actions-result');
            resultDiv.className = 'result-box';
            resultDiv.innerHTML = `<span class="loading"></span>–°–∫–∞—á–∏–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏ ${model}...`;
            resultDiv.classList.remove('hidden');

            try {
                // Simulate model download
                await simulateDockerCommand(`docker exec open-webui-hub-ollama-1 ollama pull ${model}`);
                resultDiv.className = 'result-box result-success';
                resultDiv.textContent = `‚úÖ –ú–æ–¥–µ–ª—å ${model} —É—Å–ø–µ—à–Ω–æ —Å–∫–∞—á–∞–Ω–∞`;
            } catch (error) {
                resultDiv.className = 'result-box result-error';
                resultDiv.textContent = `‚ùå –û—à–∏–±–∫–∞ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –º–æ–¥–µ–ª–∏: ${error.message}`;
            }
        }

        async function viewSystemInfo() {
            const resultDiv = document.getElementById('quick-actions-result');
            resultDiv.className = 'result-box';
            resultDiv.innerHTML = '<span class="loading"></span>–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏...';
            resultDiv.classList.remove('hidden');

            try {
                const info = `üñ•Ô∏è –°–∏—Å—Ç–µ–º–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:
‚Ä¢ –û–°: macOS (Darwin)
‚Ä¢ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞: ARM64
‚Ä¢ Docker: –ê–∫—Ç–∏–≤–µ–Ω
‚Ä¢ –î–æ—Å—Ç—É–ø–Ω–∞—è –ø–∞–º—è—Ç—å: 6.7 GiB
‚Ä¢ –†–µ–∂–∏–º GPU: CPU (GPU –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω)
‚Ä¢ –ê–∫—Ç–∏–≤–Ω—ã–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã: 5
‚Ä¢ –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø–æ—Ä—Ç—ã: 5432, 6379, 8001, 11435`;

                resultDiv.className = 'result-box result-success';
                resultDiv.textContent = info;
            } catch (error) {
                resultDiv.className = 'result-box result-error';
                resultDiv.textContent = `‚ùå –û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏: ${error.message}`;
            }
        }

        async function cleanupDocker() {
            if (!confirm('–≠—Ç–æ —É–¥–∞–ª–∏—Ç –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ Docker –æ–±—Ä–∞–∑—ã –∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã. –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å?')) return;

            const resultDiv = document.getElementById('quick-actions-result');
            resultDiv.className = 'result-box';
            resultDiv.innerHTML = '<span class="loading"></span>–û—á–∏—Å—Ç–∫–∞ Docker...';
            resultDiv.classList.remove('hidden');

            try {
                await simulateDockerCommand('docker system prune -f');
                resultDiv.className = 'result-box result-success';
                resultDiv.textContent = '‚úÖ –û—á–∏—Å—Ç–∫–∞ Docker –∑–∞–≤–µ—Ä—à–µ–Ω–∞\nüóëÔ∏è –£–¥–∞–ª–µ–Ω—ã –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –æ–±—Ä–∞–∑—ã –∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã';
            } catch (error) {
                resultDiv.className = 'result-box result-error';
                resultDiv.textContent = `‚ùå –û—à–∏–±–∫–∞ –æ—á–∏—Å—Ç–∫–∏: ${error.message}`;
            }
        }

        // Logs functions
        async function loadLogs() {
            const service = document.getElementById('log-service').value;
            const container = document.getElementById('logs-container');

            if (!service) {
                container.innerHTML = '<div class="log-line">–í—ã–±–µ—Ä–∏—Ç–µ —Å–µ—Ä–≤–∏—Å –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ª–æ–≥–æ–≤...</div>';
                return;
            }

            container.innerHTML = '<div class="log-line"><span class="loading"></span>–ó–∞–≥—Ä—É–∑–∫–∞ –ª–æ–≥–æ–≤...</div>';

            try {
                if (apiAvailable) {
                    const response = await fetch(`${API_BASE}/logs/${service}?lines=50`);
                    if (response.ok) {
                        const data = await response.json();
                        const logsHtml = data.logs.map(line => {
                            const logClass = getLogClass(line);
                            return `<div class="log-line ${logClass}">${escapeHtml(line)}</div>`;
                        }).join('');
                        container.innerHTML = logsHtml || '<div class="log-line">–õ–æ–≥–∏ –ø—É—Å—Ç—ã</div>';
                    } else {
                        throw new Error('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –ª–æ–≥–∏');
                    }
                } else {
                    // –î–µ–º–æ-—Ä–µ–∂–∏–º
                    await new Promise(resolve => setTimeout(resolve, 1000));
                    const logs = generateSampleLogs(service);
                    container.innerHTML = logs;
                }

                // Auto-scroll to bottom
                container.scrollTop = container.scrollHeight;
            } catch (error) {
                container.innerHTML = `<div class="log-line log-error">‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ª–æ–≥–æ–≤: ${error.message}</div>`;
            }
        }

        function getLogClass(logLine) {
            const line = logLine.toLowerCase();
            if (line.includes('error') || line.includes('failed')) return 'log-error';
            if (line.includes('warning') || line.includes('warn')) return 'log-warning';
            if (line.includes('info')) return 'log-info';
            if (line.includes('success') || line.includes('ready')) return 'log-success';
            return '';
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        function generateSampleLogs(service) {
            const timestamp = new Date().toISOString();
            const logs = {
                'ollama': [
                    `<div class="log-line log-info">[${timestamp}] INFO: Ollama server started on port 11434</div>`,
                    `<div class="log-line log-info">[${timestamp}] INFO: GPU detection: no compatible GPUs found</div>`,
                    `<div class="log-line log-info">[${timestamp}] INFO: Using CPU inference mode</div>`,
                    `<div class="log-line log-success">[${timestamp}] INFO: Server ready to accept connections</div>`
                ],
                'db': [
                    `<div class="log-line log-info">[${timestamp}] LOG: database system is ready to accept connections</div>`,
                    `<div class="log-line log-info">[${timestamp}] LOG: pgvector extension loaded successfully</div>`,
                    `<div class="log-line log-success">[${timestamp}] LOG: PostgreSQL init process complete</div>`
                ],
                'redis': [
                    `<div class="log-line log-info">[${timestamp}] * Ready to accept connections</div>`,
                    `<div class="log-line log-info">[${timestamp}] * Redis Stack server started</div>`,
                    `<div class="log-line log-success">[${timestamp}] * Web UI available on port 8001</div>`
                ],
                'openwebui': [
                    `<div class="log-line log-warning">[${timestamp}] WARNING: Service still downloading</div>`,
                    `<div class="log-line log-info">[${timestamp}] INFO: Download progress: 60%</div>`
                ],
                'watchtower': [
                    `<div class="log-line log-info">[${timestamp}] INFO: Watchtower started</div>`,
                    `<div class="log-line log-info">[${timestamp}] INFO: Monitoring containers for updates</div>`,
                    `<div class="log-line log-success">[${timestamp}] INFO: All containers up to date</div>`
                ]
            };

            return logs[service] ? logs[service].join('') : '<div class="log-line">–õ–æ–≥–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</div>';
        }

        function clearLogs() {
            document.getElementById('logs-container').innerHTML = '<div class="log-line">–õ–æ–≥–∏ –æ—á–∏—â–µ–Ω—ã</div>';
        }

        function downloadLogs() {
            const service = document.getElementById('log-service').value;
            if (!service) {
                alert('–í—ã–±–µ—Ä–∏—Ç–µ —Å–µ—Ä–≤–∏—Å –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –ª–æ–≥–æ–≤');
                return;
            }

            const logs = document.getElementById('logs-container').textContent;
            const blob = new Blob([logs], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `${service}-logs-${new Date().toISOString().split('T')[0]}.txt`;
            a.click();
            URL.revokeObjectURL(url);
        }

        // Utility functions
        async function simulateDockerCommand(command) {
            // Simulate command execution delay
            await new Promise(resolve => setTimeout(resolve, 2000 + Math.random() * 3000));

            // Simulate occasional failures
            if (Math.random() < 0.1) {
                throw new Error('–ö–æ–º–∞–Ω–¥–∞ –∑–∞–≤–µ—Ä—à–∏–ª–∞—Å—å —Å –æ—à–∏–±–∫–æ–π');
            }

            return { success: true, output: 'Command executed successfully' };
        }

        // Keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey || e.metaKey) {
                switch(e.key) {
                    case 'r':
                        e.preventDefault();
                        refreshStatus();
                        break;
                    case 't':
                        e.preventDefault();
                        testOllama();
                        break;
                }
            }
        });
    </script>
</body>
</html>
